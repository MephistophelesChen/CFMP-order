# HPA æµé‡çªå‘ä¼˜åŒ–æŒ‡å—

## ğŸš¨ é—®é¢˜æè¿°
HPA é»˜è®¤é…ç½®åœ¨æµé‡çªå‘æ—¶å“åº”è¾ƒæ…¢ï¼Œä¸»è¦é—®é¢˜ï¼š
- ç¨³å®šæœŸè¿‡é•¿ï¼ˆ5åˆ†é’Ÿæ— æ³•æ‰©å®¹ï¼‰
- CPU/å†…å­˜é˜ˆå€¼è®¾ç½®è¿‡é«˜
- æ‰©å®¹ç­–ç•¥è¿‡äºä¿å®ˆ

## âš¡ ç®€åŒ–ä¼˜åŒ–æ–¹æ¡ˆ

**åªéœ€è¦ä¿®æ”¹ç°æœ‰ HPA é…ç½®ï¼Œæ— éœ€é¢å¤–ç»„ä»¶ï¼**

### å…³é”®ä¼˜åŒ–ç‚¹ï¼š
1. **é™ä½è§¦å‘é˜ˆå€¼**ï¼šCPU 70%â†’60%ï¼Œå†…å­˜ 80%â†’70%
2. **ç¼©çŸ­ç¨³å®šæœŸ**ï¼šæ‰©å®¹ç¨³å®šæœŸä»300ç§’â†’30ç§’
3. **æ¿€è¿›æ‰©å®¹ç­–ç•¥**ï¼šå…è®¸100%æ‰©å®¹ï¼ˆç¿»å€ï¼‰
4. **åˆç†å‰¯æœ¬æ•°é™åˆ¶**ï¼šé¿å…èµ„æºæµªè´¹

## ğŸš€ éƒ¨ç½²æ­¥éª¤

```bash
# 1. å¤‡ä»½ç°æœ‰é…ç½®
kubectl get hpa -n cfmp-order -o yaml > hpa-backup.yaml

# 2. åº”ç”¨ä¼˜åŒ–é…ç½®
kubectl apply -f k8s/hpa-optimized.yaml

# 3. éªŒè¯é…ç½®
kubectl get hpa -n cfmp-order
kubectl describe hpa order-service-hpa -n cfmp-order
```

## ğŸ“Š æ•ˆæœå¯¹æ¯”

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹è¿› |
|-----|-------|-------|------|
| æ‰©å®¹å»¶è¿Ÿ | 5åˆ†é’Ÿ+ | 30-60ç§’ | **83%â†“** |
| CPUè§¦å‘ç‚¹ | 70% | 60% | æ›´æ—©å“åº” |
| å†…å­˜è§¦å‘ç‚¹ | 80% | 70% | æ›´æ—©å“åº” |
| æ‰©å®¹å¹…åº¦ | 25% | 100% | æ›´å¿«æ‰©å®¹ |

## ğŸ”§ é…ç½®è¯´æ˜

### å…³é”®å‚æ•°è§£é‡Šï¼š
```yaml
scaleUp:
  stabilizationWindowSeconds: 30  # å…³é”®ï¼šä»300ç§’é™åˆ°30ç§’
  policies:
  - type: Percent
    value: 100  # å…è®¸ç¿»å€æ‰©å®¹
    periodSeconds: 60
  selectPolicy: Max  # é€‰æ‹©æœ€æ¿€è¿›çš„ç­–ç•¥
```

### æœåŠ¡å·®å¼‚åŒ–é…ç½®ï¼š
- **è®¢å•æœåŠ¡**ï¼šæœ€å¤§15ä¸ªå‰¯æœ¬ï¼Œå¿«é€Ÿå“åº”
- **æ”¯ä»˜æœåŠ¡**ï¼šæœ€å¤§12ä¸ªå‰¯æœ¬ï¼Œç¼©å®¹æ›´ä¿å®ˆ
- **é€šçŸ¥æœåŠ¡**ï¼šæœ€å¤§8ä¸ªå‰¯æœ¬ï¼Œè½»é‡é…ç½®

## ï¿½ ç›‘æ§éªŒè¯

```bash
# è§‚å¯Ÿæ‰©ç¼©å®¹è¡Œä¸º
watch kubectl get pods -n cfmp-order

# æŸ¥çœ‹HPAçŠ¶æ€
kubectl get hpa -n cfmp-order -w

# å‹åŠ›æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
kubectl run busybox --image=busybox --rm -it --restart=Never -- \
  while true; do wget -q -O- http://order-service.cfmp-order:8001/api/orders/; done
```

## âœ… é¢„æœŸæ•ˆæœ

- **æµé‡çªå‘æ—¶**ï¼š30-60ç§’å†…å¼€å§‹æ‰©å®¹
- **æ­£å¸¸è´Ÿè½½**ï¼šä¿æŒåˆç†çš„å‰¯æœ¬æ•°
- **èµ„æºæ¶ˆè€—**ï¼šä¸ä¼šæ˜¾è‘—å¢åŠ æœåŠ¡å™¨è´Ÿæ‹…
- **ç¨³å®šæ€§**ï¼šç¼©å®¹ä»ç„¶ä¿å®ˆï¼Œé¿å…éœ‡è¡

è¿™ä¸ªç®€åŒ–æ–¹æ¡ˆæ—¢è§£å†³äº†æµé‡çªå‘å“åº”é—®é¢˜ï¼Œåˆé¿å…äº†å¤æ‚ç»„ä»¶çš„ç»´æŠ¤æˆæœ¬ï¼
